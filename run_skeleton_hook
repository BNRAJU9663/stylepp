TOP=`git rev-parse --show-toplevel`
DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

for CUP in $*; do
  gcc -g $DIR/$CUP.c -o $DIR/bin/$CUP

  for I in `git diff --name-only`; do
    I=$TOP/$I
    if [ ${I: -2} == ".c" ] || [ ${I: -2} == ".h" ]; then
      echo $I
      if $DIR/bin/$CUP $I <$I > /tmp/fmt; then
        echo $I
        mv /tmp/fmt $I
      fi
    fi
  done
done

